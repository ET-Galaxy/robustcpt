to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.32,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.32,
to = 10,add = TRUE, lwd = 2, col = "green")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.3,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.3,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
(2.1/0.1)^(1/2)*0.28
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.28,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.28,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.28,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.28,
to = 10,add = TRUE, lwd = 2, col = "green")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.3,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.3,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
title = "v=2, eps=0",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
# Read CSV with no header
data1 <- read.csv("data/Latest_format/rawdata/locationsv2e10final.csv")
# Read CSV with no header
data1 <- read.csv("data/Latest_format/rawdata/locations_v2e10final.csv")
# ==== Data treatment ====
data2 <- read.csv("data/Latest_format/rawdata/locations_v2e10final.csv", header = FALSE)
data_bars<-data2
data_bars[data_bars == -1] <- 2401
data_bars
detected_long <- data_bars %>%
mutate(snr = c(0:30)/20) %>%
pivot_longer(-snr, values_to = "stoppingT")
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
detected_long <- data_bars %>%
mutate(snr = c(0:30)/20) %>%
pivot_longer(-snr, values_to = "stoppingT")
c(0:30)/20
c(0:30)/2
c(0:3)/50
detected_long <- data_bars %>%
mutate(snr = c(0:15)/50) %>%
pivot_longer(-snr, values_to = "stoppingT")
colnames(detected_long)[2]<-"trial"
total<-rbind(data1,as.data.frame(detected_long))
detected_long
#write.csv(total,"data/Latest_format/locations_v2e10all.csv", row.names = FALSE)
write.csv(detected_long,
"data/Latest_format/locations_v2e10_1000sim.csv", row.names = FALSE)
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locations_v2e10_1000sim.csv")
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
detected_long <- data1 %>%
filter(stoppingT > 600, snr>=0.08) %>%
mutate(snr = factor(snr))
ggplot(detected_long, aes(x = snr, y = stoppingT-600)) +
geom_boxplot(fill = "steelblue", outlier.color = "red") +
labs(x = "Signal size", y = "Detection delay", title = "Detection delay against signal size (v=2, eps=0.05)") +
theme_minimal()
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT))
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
props <- data1 %>%
#filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0.1"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
props
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locations_v2e10all.csv")
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0.1"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT))
result$meanT<-result$meanT-600
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# ==== Data treatment ====
data2 <- read.csv("data/Latest_format/rawdata/locations_v2e10_R2R3.csv", header = FALSE)
data_bars<-data2
data_bars[data_bars == -1] <- 2401
detected_long <- data_bars %>%
mutate(snr = c(0:15)/50) %>%
pivot_longer(-snr, values_to = "stoppingT")
detected_long <- data_bars %>%
mutate(snr = c(8:50)/100) %>%
pivot_longer(-snr, values_to = "stoppingT")
colnames(detected_long)[2]<-"trial"
#write.csv(total,"data/Latest_format/locations_v2e10all.csv", row.names = FALSE)
write.csv(detected_long,
"data/Latest_format/locations_v2e10_1000sim.csv", row.names = FALSE)
detected_long
write.csv(detected_long,
"data/Latest_format/locations_v2e10R2R3.csv", row.names = FALSE)
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0.1"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locations_v2e10R2R3.csv")
# Apply row-wise
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0.1"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
# Group by snr and compute proportions
props <- data1 %>%
%filter(snr<=0.08) %>%
props <- data1 %>%
# filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0.1"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
detected_long <- data1 %>%
filter(stoppingT > 600, snr>=0.08) %>%
mutate(snr = factor(snr))
ggplot(detected_long, aes(x = snr, y = stoppingT-600)) +
geom_boxplot(fill = "steelblue", outlier.color = "red") +
labs(x = "Signal size", y = "Detection delay", title = "Detection delay against signal size (v=2, eps=0.05)") +
theme_minimal()
detected_long
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT), varT=var(stoppingT))
result
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT), sdT=sd(stoppingT))
result
result$meanT<-result$meanT-600
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
mod<-lm(meanT~I((snr)^(-2))+0, data=result)
summary(mod)
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.5, add = TRUE, lwd = 2, col = "blue")
mod<-lm(meanT~I((snr)^(-2))+0, data=result, weights = 1/sdT)
summary(mod)
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.5, add = TRUE, lwd = 2, col = "blue")
mod<-glm(meanT~I((snr)^(-2))+0, data=result, family="normal", weights = 1/sdT)
mod<-glm(meanT~I((snr)^(-2))+0, data=result, family=normal, weights = 1/sdT)
?glm
mod<-glm(meanT~I((snr)^(-2))+0, data=result, weights = 1/sdT)
summary(mod)
plot(mod, which=1)
mod<-glm(meanT~I((snr)^(-2))+0, data=result)
summary(mod)
plot(mod, which=1)
mod<-glm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.2,], family=normal, weights = 1/sdT)
mod<-glm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.2,], weights = 1/sdT)
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.5, add = TRUE, lwd = 2, col = "blue")
mod<-glm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.15,], weights = 1/sdT)
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.3,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.15, add = TRUE, lwd = 2, col = "blue")
mod2<-lm(meanT~I((log(snr*4.582576*2))^(-1))+0, data=result[result$snr>=0.15,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
mod2<-lm(meanT~I((log(snr*4.582576*2))^(-1))+0, data=result[result$snr>=0.15,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.15, add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.15,
to = 10,add = TRUE, lwd = 2, col = "green")
mod2<-lm(meanT~I((log(snr*4.582576*3))^(-1))+0, data=result[result$snr>=0.15,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.15,
to = 10,add = TRUE, lwd = 2, col = "green")
mod2<-lm(meanT~I((log(snr*4.582576*3))^(-1))+0, data=result[result$snr>=0.15,], weights = 1/sdT)
mod<-glm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.15,], weights = 1/sdT)
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576*3))^(-1))+0, data=result[result$snr>=0.15,], weights = 1/sdT)
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Mean Detection delay",
pch = 19)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.5), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.15, add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.15,
to = 0.5,add = TRUE, lwd = 2, col = "green")
plot(mod, which=1)
plot(mod2, which=1)
mod2<-lm(meanT~I((log(snr*4.582576*2.5))^(-1))+0, data=result[result$snr>=0.15,], weights = 1/sdT)
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(mod2, which=1)
