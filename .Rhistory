ggplot(props_long, aes(x = row_label, y = proportion, fill = category)) +
geom_bar(stat = "identity") +
geom_hline(yintercept = 0.2, linetype = "dotted", color = "yellow", size = 1)+
labs(x = "Signal size", y = "Proportion", title = "Proportion of Successful Detection against signal size (v=2, eps=0.05)") +
scale_fill_manual(values = c("not_detected" = "orange", "false_alarm" = "red", "detected" = "steelblue")) +
theme_minimal()
# Boxplot
detected_long <- data[-1,] %>%
mutate(row_label = rownames(props)[-1]) %>%
pivot_longer(-row_label, values_to = "value") %>%
filter(value > 600) %>%
mutate(row_label = factor(row_label, levels = desired_order[-1]))
ggplot(detected_long, aes(x = row_label, y = value-600)) +
geom_boxplot(fill = "steelblue", outlier.color = "red") +
labs(x = "Signal size", y = "Detection delay", title = "Detection delay against signal size (v=2, eps=0.05)") +
theme_minimal()
install.packages("sf")
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locationsv2all.csv")
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- detected_long %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- detected_long %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = "SNR",
y = "Proportion",
fill = "Category",
title = "Proportion of Outcomes by SNR"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
props
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT))
mod<-lm(meanT~I((snr)^(-2)), data=result[result$snr<=0.2,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1)), data=result[result$snr>=0.25,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19)
mod<-lm(meanT~I((snr)^(-2)), data=result[result$snr<=0.3,])
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.2,1))
result
result$meanT<-result$meanT-600
mod<-lm(meanT~I((snr)^(-2)), data=result[result$snr<=0.3,])
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.3,])
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
fitted.values(mod)
result[result$snr<=0.3,]
subdata<-result[result$snr<=0.3,]
subdata$fitted<-fitted.values(mod)
subdata
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.2,])
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.2,])
summary(mod)
result[result$snr <=
0.2, ]
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.2,add = TRUE, lwd = 2, col = "blue")
0.2*4.582576
# mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.2,])
mod2<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr>=0.2,])
summary(mod2)
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.2,
to = 10,add = TRUE, lwd = 2, col = "green")
result
subdata2<-result[result$snr>=0.2,]
subdata2$fit<-fitted.values(mod2)
subdata2
# mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.2,])
mod2<-lm(meanT~I((log(snr*6))^(-2))+0, data=result[result$snr>=0.2,])
summary(mod2)
# mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.2,])
mod2<-lm(meanT~I((log(snr*4.582576))^(-2))+0, data=result[result$snr>=0.2,])
summary(mod2)
mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
1/4.582576
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locations_v2e10all.csv")
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = "SNR",
y = "Proportion",
fill = "Category",
title = "Proportion of Outcomes by SNR"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT))
result$meanT<-result$meanT-600
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.22,])
summary(mod)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.2,add = TRUE, lwd = 2, col = "blue")
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.22,add = TRUE, lwd = 2, col = "blue")
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.22,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.2,
to = 10,add = TRUE, lwd = 2, col = "green")
mod2
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.22,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.22,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.22,
to = 10,add = TRUE, lwd = 2, col = "green")
fitted.values(mod2)
mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.22,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.22,
to = 10,add = TRUE, lwd = 2, col = "green")
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locations_v2e10all.csv")
# Read CSV with no header
data1 <- read.csv("data/Latest_format/locationsv2all.csv")
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
library(ggplot2)
library(tidyr)
library(dplyr)
library(tibble)
# Function to compute proportions for each row
get_proportions <- function(x) {
total <- length(x)
c(
not_detected = sum(x >= 2400) / total,
false_alarm = sum(x >= 0 & x <= 600) / total,
detected = sum(x > 600 & x < 2400) / total
)
}
# Apply row-wise
# Group by snr and compute proportions
props <- data1 %>%
filter(snr<=0.08) %>%
group_by(snr) %>%
reframe(
tibble::as_tibble_row(get_proportions(stoppingT))
)
props$false_alarm[1]<-props$false_alarm[1]+props$detected[1]
props$detected[1]<-0
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = "SNR",
y = "Proportion",
fill = "Category",
title = "Proportion of Outcomes by SNR"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
props_longer<- props %>%
pivot_longer(
cols = c(not_detected, false_alarm, detected),
names_to = "category",
values_to = "proportion") %>%
mutate(category = factor(category,
levels = c("detected","not_detected","false_alarm")))
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = "v=2, eps=0"
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
ggplot(props_longer, aes(x = factor(snr), y = proportion, fill = category)) +
geom_bar(stat = "identity") +
labs(
x = expression(kappa/phi),
y = "Proportion",
fill = "Category",
title = expression(v=2, epsilon=0)
) +
scale_fill_manual(
values = c(
false_alarm  = "firebrick2",
not_detected = "gold",
detected     = "forestgreen"
)
) +
theme_minimal(base_size = 14)
detected_long <- data1 %>%
filter(snr >=0.08)%>%
filter(stoppingT > 600)
result <- detected_long %>%
group_by(snr) %>%
summarise(meanT = mean(stoppingT))
result$meanT<-result$meanT-600
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.22,])
summary(mod)
mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.22,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.05,1))
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,500))
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,400))
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
(2.1/0.1)^(1/2)
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.32,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.32,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.22,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.22,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.32,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.32,
to = 10,add = TRUE, lwd = 2, col = "green")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.3,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.3,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
(2.1/0.1)^(1/2)*0.28
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.28,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.28,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = "Signal-to-noise ratio",
ylab = "Detection time",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.28,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.28,
to = 10,add = TRUE, lwd = 2, col = "green")
mod<-lm(meanT~I((snr)^(-2))+0, data=result[result$snr<=0.3,])
summary(mod)
mod2<-lm(meanT~I((log(snr*4.582576))^(-1))+0, data=result[result$snr>=0.3,])
#mod2<-lm(meanT~I((log(snr*6))^(-1))+0, data=result[result$snr>=0.2,])
summary(mod2)
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,1), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
plot(result$snr, result$meanT,
xlab = expression(kappa/phi),
ylab = "Mean Detection delay",
title = "v=2, eps=0",
pch = 19, xlim=c(0.1,0.6), ylim=c(0,300))
# add fitted regression line
curve(predict(mod, newdata = data.frame(snr = x)), from = 0,
to = 0.3,add = TRUE, lwd = 2, col = "blue")
curve(predict(mod2, newdata = data.frame(snr = x)), from = 0.3,
to = 10,add = TRUE, lwd = 2, col = "green")
